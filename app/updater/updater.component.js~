angular.module("updater", [
    'ngRoute',
    'contentForm',
]);

angular.module("updater").component("updater", {
    template: "<loader></loader><update-form></update-form>"
});

angular.module("updater").component("loader", {
    templateUrl: '/static/app/templates/spinner.template.html'
    controller: function() {
	this.loaded = false;
	this.toggleLoaded = function() {
	    this.loaded = !this.loaded;
	}
    }
});

angular.module("updater").component("updateForm", {
    templateUrl: '/static/app/templates/form.template.html',
    require: {
	spinner: "^loader"
    }
    controller: ['$element', '$location', 'simpleMdE', function($element, $location, simpleMdE) {

	simpleMdE.initEditor($element.find('textarea')[0]);
	this.author = '';
	this.hours ='';
	this.minutes = '';
	this.email = '';
	this.update = true;
	this.msg = "";
	
	this.anyFieldEmpty = function() {
	    return (
		this.author === "" ||
		this.hours === "" ||
		this.minutes === "" ||
		this.email === ""    
	    );
	}

	this.validEmail = function(valid) {
	    if (this.email === "") return "input is-primary";
	    if (valid) return "input is-success";
	    else return "input is-danger";
	}
    }]
});
